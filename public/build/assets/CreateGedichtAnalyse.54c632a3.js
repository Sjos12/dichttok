import{_ as $}from"./PrimaryButton.331c1263.js";import{a as A}from"./AuthenticatedLayout.c312c392.js";import{y as r,i as R,o as c,c as m,w as y,b as a,g as d,F as _,s as k,x as j,n as z,t as M,k as N,d as u,a as V,e as I,B as E}from"./app.3bc86724.js";import{S as G,_ as H}from"./GedichtFragment.06f5f4dc.js";import"./ApplicationLogo.fdf79451.js";import"./_plugin-vue_export-helper.cdc0426e.js";const P=u("div",{class:"flex justify-between items-center"},[u("h2",{class:"font-semibold text-xl text-gray-800 dark:text-gray-200 leading-tight"}," Analyse maken ")],-1),T=["onClick"],D={class:"card mx-auto"},L={class:"text-gray-100 mt-5 text-lg font-light leading-loose whitespace-pre-wrap"},U={class:"flex mt-5"},Y={__name:"CreateGedichtAnalyse",props:{auth:Object,gedicht:Object,stijlmiddelen:Object},setup(x){const h=x;let n=r({});const o=r([]),i=r([{type:"unedited",start:0,end:h.gedicht.gedicht.length}]),f=R(h.gedicht.gedicht),g=r({x:null,y:null});function b(t){console.log(t.start),n=r({start:0,end:0,type:"highlight",stijlmiddel:h.stijlmiddelen[0]});let e=w();if(e.anchorOffset<e.focusOffset?(n.start=t.start+e.anchorOffset,n.end=t.start+e.focusOffset):(n.start=t.start+e.focusOffset,n.end=t.start+e.anchorOffset),n.end-n.start==0)return;let l=e.getRangeAt(0).getBoundingClientRect();g.x=l.x,g.y=l.y,o.push(n),S(),v(),O()}function w(){let t={};if(window.getSelection||document.getSelection)t=window.getSelection();else if(document.selection)t=document.selection;else return;return console.log(t),t}function v(){i.splice(0),console.log(i),o.forEach(e=>{i.push(e)}),i.splice(0,0,{start:0,end:o[0].start,type:"unedited"});for(let e=0;e<o.length;e++){let s=o[e],l=o[e+1];!s||!l||i.splice(e,0,{start:s.end,end:l.start})}let t=o[o.length-1];i.splice(i.length-1,0,{start:t.end,end:f.value.length,type:"unedited"})}function O(){i.sort((t,e)=>t.start-e.start)}function S(){o.sort((t,e)=>t.start-e.start)}const C=t=>t==n.stijlmiddel;function B(){let t=route("gedicht.analyze.create",h.gedicht.uuid);E.Inertia.post(t,{highlightFragments:o})}function F(t){n.stijlmiddel=t}return(t,e)=>(c(),m(A,null,{header:y(()=>[P]),default:y(()=>[a(n).start?(c(),d("div",{key:0,class:"card flex z-50 gap-3 absolute shadow-lg overflow-x-auto bg-gray-800 p-2",style:j({top:a(g).y-80+"px",left:a(g).x+"px"})},[(c(!0),d(_,null,k(x.stijlmiddelen,s=>(c(),d("button",{key:s.id,style:j({backgroundColor:s.color}),class:z(["text-white shadow-md rounded-md p-2 duration-100",C(s)?"border-b-2 border-b-white font-medium":""]),onClick:l=>F(s)},M(s.name),15,T))),128))],4)):N("",!0),u("div",D,[u("p",L,[(c(!0),d(_,null,k(a(i),(s,l)=>(c(),d(_,null,[s.type=="highlight"?(c(),m(G,{onMouseup:p=>b(s),content:a(f).slice(s.start,s.end),ref_for:!0,ref:p=>{s.element=p},stijlmiddel:s.stijlmiddel,key:l},null,8,["onMouseup","content","stijlmiddel"])):(c(),m(H,{onMouseup:p=>b(s),content:a(f).slice(s.start,s.end),key:l*2},null,8,["onMouseup","content"]))],64))),256))]),u("div",U,[V($,{onClick:B,class:"ml-auto"},{default:y(()=>[I("Opslaan")]),_:1})])])]),_:1}))}};export{Y as default};
